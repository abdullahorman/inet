%description:
Test Uint128 class

%includes:
#include "uint128.h"

%global:

static void compare(Uint128 a, Uint128 b, const char *str)
{
    if (a != b)
        ev << str << ": a != b" << "\n  (a=" << std::string(a.toString()) << "=" << std::string(a.toString(16)) << "H),"
           << " (b=" << std::string(b.toString()) << "=" << std::string(b.toString(16)) << "H)\n";
    if (a < b)
        ev << "  a < b\n";
    if (a > b)
        ev << "  a > b\n";
}

%activity:

ev << "BEGIN\n";

#define COMPARE(x,y)  compare( (x), (y), "compare(" #x ", " #y ")" )

COMPARE(-Uint128(0), Uint128(0u));
COMPARE(Uint128(9)*Uint128(7), Uint128(63));
COMPARE((Uint128(9))*(Uint128(7)<<64u), Uint128(63)<<64u);
COMPARE((Uint128(9)<<64u)*(Uint128(7)), Uint128(63)<<64u);
COMPARE((Uint128(9)<<32u)*(Uint128(7)<<32u), Uint128(63)<<64u);
COMPARE((Uint128(9)<<62u)*(Uint128(7)), Uint128(63)<<62u);
COMPARE((Uint128(9))*(Uint128(7)<<62u), Uint128(63)<<62u);
COMPARE(-(Uint128(1)<<64u), (-Uint128(1))<<64u);
COMPARE((-(Uint128(12342)<<64u)) + (Uint128(12342)<<64u), Uint128(0));
COMPARE(Uint128(1534) * Uint128(323412341l) / Uint128(1534), Uint128(323412341l));
COMPARE(Uint128(65536l) * Uint128(65536l) * Uint128(65536l) * Uint128(65536l), Uint128(1)<<64u);

#undef COMPARE

ev << "END\n";

%contains: stdout
BEGIN
END
